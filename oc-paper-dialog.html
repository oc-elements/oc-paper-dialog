<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-dialog/paper-dialog.html"

<dom-module id="oc-paper-dialog">
  <template>
    <paper-dialog
            id='paperDeleteDialog'
            modal
            no-cancel-on-esc-key
            no-cancel-on-outside-click
            on-iron-overlay-opened="_patchOverlay" >
      <h2>Delete [[subject]] </h2>
      <p>
        Are you sure you want to delete [[resource]]?
      </p>
      <div class="buttons">
        <paper-button class="btn btn-default" dialog-dismiss autofocus on-tap="close">Cancel</paper-button>
        <paper-button class="btn btn-danger"  dialog-confirm on-tap="_handleEvent">Delete</paper-button>
      </div>
    </paper-dialog>
  </template>

  <script>
    /**
     * `oc-paper-dialog`
     * Papaer Dialog box that can return a value
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class OcPaperDialog extends Polymer.Element {
      static get is() { return 'oc-paper-dialog'; }
      static get properties() {
          return {
              //used in the heading
              subject: {
                  type: String,
                  value: "Resource",
                  notify: true
              },
              //used in the body of the dialog
              resource: {
                  type: String,
                  value: "resource"
              },
              //id of the record to remove
              key: {
                  type: String,
                  notify: true
              },
              //name of the event to fire
              eventName: {
                  type: String,
                  notify: true,
                  value: "event"
              }
          }
      }

      _handleEvent(e) {
          this.dispatchEvent(new CustomEvent(this.eventName, {
              bubbles: true, composed: true, detail:
                  {id : this.key}
          }));
      }

      open() {
          this.$.paperDeleteDialog.open();
      }

      close(){
          this.$.paperDeleteDialog.close();
      }

      _patchOverlay(e){
          if (e.target.withBackdrop) {
              e.target.parentNode.insertBefore(e.target.backdropElement, e.target);
          }
      }

    }

    window.customElements.define(OcPaperDialog.is, OcPaperDialog);
  </script>
</dom-module>
